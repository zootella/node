<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>v1source</title>
<script type="text/javascript" src="page.js"></script>
</head>
<body>

<!-- earlier unrelated page at the top -->
<h1>v1source</h1>
<div>
We are using node <script>document.write(process.versions.node)</script>,
Chrome <script>document.write(process.versions.chrome)</script>,
and Electron <script>document.write(process.versions.electron)</script>.
</div>

<!-- first source the vue library -->
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

<!-- define components -->
<script>
Vue.component('fruit', {
	props: ['f'],
	template: `
		<div>
			{{ f.quantity }} {{ f.color }} {{ f.name }}(s)
			<button v-on:click="f.more">More</button>
			<button v-on:click="f.less">Less</button>
		</div>
	`
});
</script>

<!-- make the app, and use components -->
<div id="app">
<p>now let's try some components</p>
<p>
	<button v-on:click="method1">Method 1</button>
	<button v-on:click="method2">Method 2</button>
	<button v-on:click="method3">Method 3</button>
</p>
<p>{{ message }}</p>
<ol>
	<fruit v-for="f in fruits" v-bind:key="f.id" v-bind:f="f"></fruit>
</ol>
</div>

<!-- define the app component -->
<script>

let a = "a";

var app = new Vue({
	el: '#app',
	data: {
		title: 'this is the starting title',
		message: 'this is the starting message',
		fruits: []
	},
	methods: {
		method1() {
			this.fruits.push(makeFruit(5, "yellow", "banana"));
			this.fruits.push(makeFruit(12, "red", "apple"));
			this.fruits.push(makeFruit(3, "brown", "kiwi"));
		},
		method2() {
			this.fruits[1].quantity = 0;//second, this works
		},
		method3() {
			wayOutside();
		},
	}
});

function wayOutside() {
	console.log("way outside");
	app.fruits[2].quantity = 100;//third, this works
}

function makeFruit(quantity, color, name) {
	let o = {};
	o.id = makeUnique();
	o.quantity = quantity;
	o.color = color;
	o.name = name;
	o.more = function() { o.quantity++; }//first, this works
	o.less = function() { o.quantity--; }
	return o;
}

// Make a unique identifier for a new element on the page, from "idn1" through "idn9000000000000000" and then "idnn1", quick and infinite
let unique_i, unique_s;
function makeUnique() {
	if (!unique_s) unique_s = "id"; // Starting prefix
	if (!unique_i || unique_i > 9000000000000000) { unique_s += "n"; unique_i = 1; } // It's over nine thousand! actually quadrillion
	return unique_s + unique_i++; // Increment number for next time
}

</script>
</body>
</html>
